## 什么是中间人攻击？如何防止攻击？

* 首先了解到的是TLS加密通信，一旦会话初始化完成，想要完成中间人攻击是非常困难的。TLS的中间人攻击是针对  
  加密会话的初始化阶段进行的，而不是实际通信的阶段。加密通信的初始化阶段，需要通过非对称密码算法来协商密钥，  
  然后用协商好的密钥，使用对称加密算法进行实际的通信。

* 中间人攻击
  * 所谓的中间人攻击，其实就是指攻击者分别针对客户端和服务端创建独立的联系，并交换其所收到的数据，使得通讯  
    的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。在中间人攻击中  
    攻击者可以拦截通讯双方的通话并插入新的内容。中间人攻击是一个缺乏相互认证的攻击。大多数的加密协议都专门  
    加入了一些特殊认证方式来阻止中间人攻击。例如SSL协议可以验证参与通讯的一方或双方使用的证书是否是权威的  
    受信任的数字证书认证机构所颁发的，并且能执行双向身份认证。

* 攻击过程
  * 1.客户端发送请求到服务端，请求被中间人截获。
  * 2.服务器向客户端发送公钥。
  * 3.中间人截获服务器端发送过来的公钥，保留在自己手上。然后自己生成一个「伪造的」公钥，发给客户端。
  * 4.客户端收到伪造的公钥后，自己通过对称加密算法生成密钥，通过中间人发送过来的公钥进行加密。
  * 5.中间人获取到客户端发送过来的通过自己的公钥加密的密钥。然后自己再通过对称加密算法生成一个假的密钥，通过  
    第三步获取到的公钥进行加密，发送给服务器端
  * 6.服务器用私钥来解密中间人发送过来的假密钥。以后所要传输的数据都会通过中间人所生成的这个「伪造的」密钥进行加密通信

  ![avatar](https://pic2.zhimg.com/80/v2-552670666449b73399558b8117a527b1_720w.jpg)

* 防止中间人攻击的办法
  * 简单来说，就是在服务器端，通过CA证书认证的方式来进行公钥私钥的生成操作。认证之后，所分发出来的公钥不可被  
    篡改，并且客户端是可以认可并识别出这个通过CA证书来认证的公钥。

